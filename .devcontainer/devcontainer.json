{
  "name": "Go & Vue Dev Container",
  "image": "mcr.microsoft.com/devcontainers/universal:2",

  // 安装 Go 和 Node.js
  "features": {
    "ghcr.io/devcontainers/features/go:1": {
      "version": "latest"
    },
    "ghcr.io/devcontainers/features/node:1": {
      "version": "lts"
    }
  },

  // 转发端口
  "forwardPorts": [
    8080, // Go 后端服务
    5173  // Vue 前端开发服务
  ],

  // Codespaces 生命周期钩子
  "postCreateCommand": "chmod +x /workspaces/AutoDoc_tx/tools/init_gemlnicli.sh && /workspaces/AutoDoc_tx/tools/init_gemlnicli.sh && go version && node --version && npm --version",
  "postAttachCommand": {
    "server": "go run main.go"
  },

  // 自定义 VS Code 编辑器和插件
  "customizations": {
    "vscode": {
      // 推荐安装的 VS Code 插件列表
      "extensions": [
        // Go 语言核心支持
        "golang.go",

        // Vue.js 核心支持 (Volar)
        "Vue.volar",
        "vue.vscode-typescript-vue-plugin",

        // Shell 脚本支持
        "timonwong.shellcheck",
        "foxundermoon.shell-format",

        // 数据库客户端
        "cweijan.vscode-mysql-client2",
        "cweijan.redis-client-pro",

        // Docker & Git
        "ms-azuretools.vscode-docker",
        "eamodio.gitlens",

        // 常见文件格式支持
        "redhat.vscode-yaml",
        "yzhang.markdown-all-in-one",
        "davidanson.vscode-markdownlint",

        // 资源监控和常用工具
        "mutantdino.resourcemonitor",
        "esbenp.prettier-vscode",      // 代码格式化
        "EditorConfig.EditorConfig",   // 统一编码风格
        "ms-vsliveshare.vsliveshare",  // 实时协作
        "GitHub.copilot"               // AI 编程助手
      ],
      // 容器内的 VS Code 编辑器设置
      // 注意：为了更好地协作，部分设置移到了 .vscode/settings.json
      "settings": {}
    }
  },

  // 在容器中以非 root 用户运行
  "remoteUser": "vscode"
}
